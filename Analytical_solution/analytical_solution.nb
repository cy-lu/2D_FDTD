(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    106052,       2537]
NotebookOptionsPosition[    104694,       2491]
NotebookOutlinePosition[    105139,       2509]
CellTagsIndexPosition[    105096,       2506]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "(", "\"\< Here, the extinction/scattering/absorption spectra of a \
core-shell nanocylinder is calculated based on \n   the equations, as shown \
in Light scattering at oblique incidence on two coaxial cylinders,Applied \
Optics Vol. 33, Issue 18, pp. 4013-4024 (1994)\>\"", ")"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xiLimit", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselJp", "[", 
      RowBox[{"m_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "<", " ", "xiLimit"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{"m", ",", "x1"}], "]"}], ",", "x1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"x1", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"2", "/", 
           RowBox[{"(", 
            RowBox[{"Pi", "*", "x"}], ")"}]}], "]"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{
            RowBox[{"m", "/", "2"}], "*", "Pi"}], "-", 
           RowBox[{"Pi", "/", "4"}]}], ")"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BesselYp", "[", 
      RowBox[{"m_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "<", " ", "xiLimit"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"BesselY", "[", 
           RowBox[{"m", ",", "x1"}], "]"}], ",", "x1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"x1", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"Pi", "*", "x"}], ")"}]}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{
            RowBox[{"m", "/", "2"}], "*", "Pi"}], "-", 
           RowBox[{"Pi", "/", "4"}]}], ")"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HankelH1p", "[", 
      RowBox[{"m_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "<", " ", "xiLimit"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"HankelH1", "[", 
           RowBox[{"m", ",", "x1"}], "]"}], ",", "x1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"x1", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{"I", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"Pi", "*", "x"}], ")"}]}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"m", "/", "2"}], "*", "Pi"}], "-", 
            RowBox[{"Pi", "/", "4"}]}], ")"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"HankelH2p", "[", 
      RowBox[{"m_", ",", "x_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "<", " ", "xiLimit"}], ",", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"HankelH2", "[", 
           RowBox[{"m", ",", "x1"}], "]"}], ",", "x1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"x1", "\[Rule]", "x"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"Pi", "*", "x"}], ")"}]}], "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "I"}], "*", 
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"m", "/", "2"}], "*", "Pi"}], "-", 
            RowBox[{"Pi", "/", "4"}]}], ")"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AN", "[", 
     RowBox[{"m_", ",", "opt_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sub", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k1", "=", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}]}], "/.", "opt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"k2", "=", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Epsilon]2", " ", "\[Mu]2"}], "]"}]}], "/.", "opt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"k3", "=", 
        RowBox[{
         RowBox[{"\[Omega]", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"\[Epsilon]3", " ", "\[Mu]3"}], "]"}]}], "/.", "opt"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"r2", "=", 
        RowBox[{"r2", "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r3", "=", 
        RowBox[{"r3", "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BJ12", "=", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k1", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BJ33", "=", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k3", " ", "r3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BJp12", "=", 
        RowBox[{"BesselJp", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k1", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BJp33", "=", 
        RowBox[{"BesselJp", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k3", " ", "r3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HA122", "=", 
        RowBox[{"HankelH1", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HA123", "=", 
        RowBox[{"HankelH1", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HA212", "=", 
        RowBox[{"HankelH2", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k1", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HA222", "=", 
        RowBox[{"HankelH2", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HA223", "=", 
        RowBox[{"HankelH2", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HAp122", "=", 
        RowBox[{"HankelH1p", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HAp123", "=", 
        RowBox[{"HankelH1p", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HAp212", "=", 
        RowBox[{"HankelH2p", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k1", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HAp222", "=", 
        RowBox[{"HankelH2p", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"HAp223", "=", 
        RowBox[{"HankelH2p", "[", 
         RowBox[{"m", ",", 
          RowBox[{"k2", " ", "r3"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"HA212", ",", "0", ",", " ", 
             RowBox[{"-", "HA222"}], ",", 
             RowBox[{"-", "HA122"}], " ", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], 
                RowBox[{"\[Mu]1", " ", "\[Omega]"}]]}], "HAp212"}], ",", " ", 
             "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]2", " ", "\[Omega]"}]]}], "HAp222"}], ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]2", " ", "\[Omega]"}]]}], "HAp122"}], ",", "0", 
             ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"+", "\[ImaginaryI]"}], " ", "\[Mu]1", " ", 
                "\[Omega]"}], "k1"], "HAp212"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp222"}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp122"}], ",", "0", ",", "0", ",", "0", ",", "0"}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "HA212", ",", "0", ",", "0", ",", 
             RowBox[{"-", "HA222"}], ",", 
             RowBox[{"-", "HA122"}], ",", "0", ",", "0"}], " ", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "HA223", ",", "HA123", " ", ",", "0", ",", 
             "0", ",", 
             RowBox[{"-", "BJ33"}], ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp223"}], ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp123"}], ",", "0", ",", "0", ",", " ", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]3", " ", "\[Omega]"}], 
                "k3"]}], "BJp33"}], ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "HA223", ",", "HA123", 
             ",", "0", ",", 
             RowBox[{"-", "BJ33"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]1", " ", "\[Omega]"}]]}], "HAp223"}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]1", " ", "\[Omega]"}]]}], "HAp123"}], ",", "0", 
             ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k3"}], 
                RowBox[{"\[Omega]", "  ", "\[Mu]3"}]]}], "BJp33"}]}], "}"}]}],
           "\[IndentingNewLine]", "}"}], "/.", "opt"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"SOL", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", "\[ImaginaryI]", ")"}], "^", "m"}]}], "\[Times]",
               "BJ12"}], ",", "0", ",", " ", 
             RowBox[{"-", "HA222"}], ",", 
             RowBox[{"-", "HA122"}], " ", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k1"}], 
                RowBox[{"\[Mu]1", " ", "\[Omega]"}]]}], "HAp212"}], ",", " ", 
             "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]2", " ", "\[Omega]"}]]}], "HAp222"}], ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]2", " ", "\[Omega]"}]]}], "HAp122"}], ",", "0", 
             ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Mu]1", " ", 
                "\[Omega]"}], "k1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", "\[ImaginaryI]", ")"}], "^", "m"}], ")"}], 
              "\[Times]", "BJp12"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp222"}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp122"}], ",", "0", ",", "0", ",", "0", ",", "0"}],
             "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "HA212", ",", "0", ",", "0", ",", 
             RowBox[{"-", "HA222"}], ",", 
             RowBox[{"-", "HA122"}], ",", "0", ",", "0"}], " ", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "HA223", ",", "HA123", " ", ",", "0", ",", 
             "0", ",", 
             RowBox[{"-", "BJ33"}], ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp223"}], ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]2", " ", "\[Omega]"}], 
                "k2"]}], "HAp123"}], ",", "0", ",", "0", ",", " ", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "\[Mu]3", " ", "\[Omega]"}], 
                "k3"]}], "BJp33"}], ",", "0"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "HA223", ",", "HA123", 
             ",", "0", ",", 
             RowBox[{"-", "BJ33"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]1", " ", "\[Omega]"}]]}], "HAp223"}], ",", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k2"}], 
                RowBox[{"\[Mu]1", " ", "\[Omega]"}]]}], "HAp123"}], ",", "0", 
             ",", 
             RowBox[{
              RowBox[{"+", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "k3"}], 
                RowBox[{"\[Omega]", "  ", "\[Mu]3"}]]}], "BJp33"}]}], "}"}]}],
           "\[IndentingNewLine]", "}"}], "/.", "opt"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equ", "=", 
        RowBox[{
         RowBox[{"Det", "[", "SOL", "]"}], "/", 
         RowBox[{"Det", "[", "M", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "equ", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.458049765296875*^9, 3.4580498153125*^9}, {
   3.458051333609375*^9, 3.4580513973125*^9}, {3.45809765828125*^9, 
   3.45809769459375*^9}, {3.4580984665*^9, 3.45809846665625*^9}, {
   3.458098510734375*^9, 3.458098596140625*^9}, {3.458098641578125*^9, 
   3.458098654328125*^9}, {3.45809874546875*^9, 3.458098823640625*^9}, {
   3.45809890915625*^9, 3.45809892684375*^9}, {3.4580990021875*^9, 
   3.4580990335625*^9}, {3.458099069015625*^9, 3.458099173453125*^9}, {
   3.458099206375*^9, 3.4580992180625*^9}, {3.458099444984375*^9, 
   3.458099500921875*^9}, {3.4580995809375*^9, 3.458099589234375*^9}, {
   3.458099640234375*^9, 3.458099732953125*^9}, {3.45809987253125*^9, 
   3.45809987696875*^9}, {3.45809991809375*^9, 3.458099932140625*^9}, {
   3.458099985546875*^9, 3.458099999171875*^9}, {3.45810014725*^9, 
   3.4581002326875*^9}, {3.458100285140625*^9, 3.458100289203125*^9}, {
   3.45810033371875*^9, 3.458100437140625*^9}, {3.458100717125*^9, 
   3.458100751171875*^9}, {3.458100993078125*^9, 3.4581011703125*^9}, {
   3.45810120559375*^9, 3.45810121525*^9}, {3.45810126265625*^9, 
   3.458101311390625*^9}, {3.458101411453125*^9, 3.458101416375*^9}, {
   3.458101479421875*^9, 3.458101555640625*^9}, {3.45810158775*^9, 
   3.45810170884375*^9}, {3.458101741453125*^9, 3.4581018148125*^9}, {
   3.458101849734375*^9, 3.45810185834375*^9}, {3.45810199325*^9, 
   3.458101997984375*^9}, {3.458102043109375*^9, 3.4581021598125*^9}, {
   3.458102395109375*^9, 3.4581023994375*^9}, {3.45810244921875*^9, 
   3.45810245115625*^9}, {3.458102551625*^9, 3.458102614140625*^9}, {
   3.458112135359375*^9, 3.458112139703125*^9}, {3.45811222121875*^9, 
   3.45811225171875*^9}, {3.45811230525*^9, 3.458112326421875*^9}, {
   3.45811236509375*^9, 3.45811236865625*^9}, {3.458112439359375*^9, 
   3.458112446734375*^9}, {3.458121880765625*^9, 3.458121883453125*^9}, {
   3.458122075*^9, 3.4581221003125*^9}, {3.45812215465625*^9, 
   3.458122210140625*^9}, {3.458122449234375*^9, 3.458122449703125*^9}, {
   3.45812275178125*^9, 3.458122756875*^9}, {3.458122829265625*^9, 
   3.458122829921875*^9}, {3.458123260046875*^9, 3.45812326109375*^9}, 
   3.4581233853125*^9, {3.458123785515625*^9, 3.458123797078125*^9}, {
   3.458123950484375*^9, 3.45812395825*^9}, {3.45812401259375*^9, 
   3.458124040078125*^9}, {3.45812411809375*^9, 3.45812412246875*^9}, {
   3.4581261605*^9, 3.458126284453125*^9}, {3.45812637528125*^9, 
   3.458126377140625*^9}, {3.458128454859375*^9, 3.45812845790625*^9}, {
   3.45812854790625*^9, 3.458128550203125*^9}, {3.458128582421875*^9, 
   3.458128587421875*^9}, {3.458128805390625*^9, 3.458128834046875*^9}, {
   3.458128878671875*^9, 3.458128896859375*^9}, {3.45812910696875*^9, 
   3.458129109265625*^9}, {3.458130005265625*^9, 3.45813000903125*^9}, {
   3.45813082984375*^9, 3.458130831515625*^9}, {3.458134042390625*^9, 
   3.458134069859375*^9}, {3.45813979803125*^9, 3.4581397983125*^9}, {
   3.458139910171875*^9, 3.458140203046875*^9}, {3.458216378921875*^9, 
   3.458216387953125*^9}, {3.78259134352361*^9, 3.782591343746887*^9}, {
   3.782592957451043*^9, 3.782593125428543*^9}, {3.782650491597931*^9, 
   3.7826504918442717`*^9}}],

Cell[BoxData["\<\" Here, the extinction/scattering/absorption spectra of a \
core-shell nanocylinder is calculated based on \\n   the equations, as shown \
in Light scattering at oblique incidence on two coaxial cylinders,Applied \
Optics Vol. 33, Issue 18, pp. 4013-4024 (1994)\"\>"], "Output",
 CellChangeTimes->{
  3.782593129351283*^9, {3.7825932380234976`*^9, 3.782593261624178*^9}, 
   3.782593315588891*^9, 3.78265049819332*^9, 3.78265164419311*^9, 
   3.782655388232969*^9, 3.782656927142517*^9}]
}, Open  ]],

Cell["", "PageBreak",
 PageBreakBelow->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", " ", "=", " ", 
    RowBox[{"2.99792458", "*", 
     RowBox[{"10", "^", "8"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"speed", " ", "of", " ", "light"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]max", "=", 
   RowBox[{"2000", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], "  ", 
  RowBox[{"(*", 
   RowBox[{"2000", "nm"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]min", "=", 
   RowBox[{"200", " ", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "9"}]}]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"200", "nm"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"wmax", " ", "=", " ", 
    RowBox[{"2", "*", "3.14159", "*", 
     RowBox[{"c", "/", 
      RowBox[{"(", "\[Lambda]min", ")"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"200", "nm"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"wmin", " ", "=", " ", 
    RowBox[{"2", "*", "3.14159", "*", 
     RowBox[{"c", "/", 
      RowBox[{"(", "\[Lambda]max", ")"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"2000", "nm"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"nfreq", " ", "=", " ", "100"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wave", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{"N", "[", 
      RowBox[{"\[Lambda]min", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Lambda]max", "-", "\[Lambda]min"}], ")"}], "*", 
        RowBox[{"i", "/", 
         RowBox[{"(", 
          RowBox[{"nfreq", " ", "-", " ", "1"}], ")"}]}]}]}], "]"}]}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", "nfreq"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"w", "[", "i", "]"}], " ", "=", " ", 
     RowBox[{"2", "*", "3.14159", "*", 
      RowBox[{"c", "/", 
       RowBox[{"wave", "[", "i", "]"}]}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "1", ",", " ", "nfreq"}], "}"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"epsiloninfinite", "=", "1.1156"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sigma", "=", 
   RowBox[{"4.2399257866", "*", 
    RowBox[{"10", "^", "16"}]}]}], "\t", ";"}], "\n", 
 RowBox[{
  RowBox[{"A1", "=", "0.5548"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"phi1", "=", "2.8463"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega1", "=", 
   RowBox[{"4.506033811", "*", 
    RowBox[{"10", "^", "16"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gamma1", "=", 
   RowBox[{"5.0895798919", "*", 
    RowBox[{"10", "^", "16"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"A2", "=", "679.7606"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"phi2", "=", 
   RowBox[{"-", "0.0998"}]}], "\t", ";"}], "\n", 
 RowBox[{
  RowBox[{"omega2", "=", 
   RowBox[{"3.4587148533", "*", 
    RowBox[{"10", "^", "14"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gamma2", "=", 
   RowBox[{"3.06427186", "*", 
    RowBox[{"10", "^", "13"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"A3", "=", "3.5244"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"phi3", "=", "4.6586"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"omega3", "=", 
   RowBox[{"3.5831868337", "*", 
    RowBox[{"10", "^", "15"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"gamma3", "=", 
   RowBox[{"1.6878397906", "*", 
    RowBox[{"10", "^", "15"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"epsilon", "[", "i", "]"}], "=", 
     RowBox[{"epsiloninfinite", "+", 
      FractionBox["sigma", 
       RowBox[{"\[ImaginaryI]", "*", 
        RowBox[{"w", "[", "i", "]"}]}]], "+", 
      RowBox[{"A1", "*", "omega1", "*", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", "*", "phi1"}], "]"}], 
          RowBox[{"omega1", "-", 
           RowBox[{"w", "[", "i", "]"}], "-", 
           RowBox[{"\[ImaginaryI]", "\[Times]", "gamma1"}]}]], "+", 
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", "phi1"}], "]"}], 
          RowBox[{"omega1", "+", 
           RowBox[{"w", "[", "i", "]"}], "+", 
           RowBox[{"\[ImaginaryI]", "\[Times]", "gamma1"}]}]]}], ")"}]}], "+", 
      RowBox[{"A2", "*", "omega2", "*", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", "*", "phi2"}], "]"}], 
          RowBox[{"omega2", "-", 
           RowBox[{"w", "[", "i", "]"}], "-", 
           RowBox[{"\[ImaginaryI]", "\[Times]", "gamma2"}]}]], "+", 
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", "phi2"}], "]"}], 
          RowBox[{"omega2", "+", 
           RowBox[{"w", "[", "i", "]"}], "+", 
           RowBox[{"\[ImaginaryI]", "\[Times]", "gamma2"}]}]]}], ")"}]}], "+", 
      RowBox[{"A3", "*", "omega3", "*", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{"\[ImaginaryI]", "*", "phi3"}], "]"}], 
          RowBox[{"omega3", "-", 
           RowBox[{"w", "[", "i", "]"}], "-", 
           RowBox[{"\[ImaginaryI]", "\[Times]", "gamma3"}]}]], "+", 
         FractionBox[
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", "phi3"}], "]"}], 
          RowBox[{"omega3", "+", 
           RowBox[{"w", "[", "i", "]"}], "+", 
           RowBox[{"\[ImaginaryI]", "\[Times]", "gamma3"}]}]]}], ")"}]}]}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], " ", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"aaa", "[", "i", "]"}], "=", 
     RowBox[{"Re", "[", 
      RowBox[{"epsilon", "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"aaa", "[", "i", "]"}], "=", 
     RowBox[{"Im", "[", 
      RowBox[{"epsilon", "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"nr", "[", "i", "]"}], "=", 
     RowBox[{"Re", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"epsilon", "[", "i", "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ni", "[", "i", "]"}], "=", 
     RowBox[{"Im", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"epsilon", "[", "i", "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wave", "[", "i", "]"}], "=", 
     RowBox[{
      RowBox[{"10", "^", "6"}], "*", 
      FractionBox[
       RowBox[{"2", "\[Times]", "3.14159265", "\[Times]", "3", "\[Times]", 
        RowBox[{"10", "^", "8"}]}], 
       RowBox[{"w", "[", "i", "]"}]]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\au.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"aaa", "[", "i", "]"}], "=", 
       RowBox[{"Im", "[", 
        RowBox[{"epsilon", "[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.458141375890625*^9, 3.458141380078125*^9}, {
   3.458141433046875*^9, 3.458141527015625*^9}, 3.458141566578125*^9, 
   3.458141600671875*^9, 3.458141643890625*^9, {3.458141703203125*^9, 
   3.4581418123125*^9}, {3.45814805478125*^9, 3.458148056234375*^9}, {
   3.4582180016875*^9, 3.458218014046875*^9}, {3.461148752015625*^9, 
   3.46114875625*^9}, {3.782590820064138*^9, 3.7825908475257063`*^9}, {
   3.782590883263096*^9, 3.782590965178139*^9}, {3.782593271848702*^9, 
   3.7825932864386597`*^9}, 3.7825933452419815`*^9, {3.7825933765576544`*^9, 
   3.782593392306589*^9}, {3.7825934630196724`*^9, 3.7825935190864544`*^9}, {
   3.7826592685028543`*^9, 3.782659269596929*^9}, {3.7826600661876564`*^9, 
   3.7826600667102966`*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 FractionBox["1", "500000"]], "Output",
 CellChangeTimes->{
  3.46381262521875*^9, 3.463812729484375*^9, 3.46382748978125*^9, 
   3.46650294546875*^9, 3.466654350125*^9, 3.7825908358414583`*^9, 
   3.782590886407711*^9, {3.782590922072133*^9, 3.7825909656863093`*^9}, {
   3.7825932676582994`*^9, 3.7825933929409246`*^9}, {3.7825934703271093`*^9, 
   3.7825935205696135`*^9}, 3.782650502466862*^9, {3.782651647265892*^9, 
   3.7826516518845387`*^9}, 3.782655395134509*^9, 3.782656929821319*^9, 
   3.782659272522105*^9, 3.7826605316776743`*^9}],

Cell[BoxData[
 FractionBox["1", "5000000"]], "Output",
 CellChangeTimes->{
  3.46381262521875*^9, 3.463812729484375*^9, 3.46382748978125*^9, 
   3.46650294546875*^9, 3.466654350125*^9, 3.7825908358414583`*^9, 
   3.782590886407711*^9, {3.782590922072133*^9, 3.7825909656863093`*^9}, {
   3.7825932676582994`*^9, 3.7825933929409246`*^9}, {3.7825934703271093`*^9, 
   3.7825935205696135`*^9}, 3.782650502466862*^9, {3.782651647265892*^9, 
   3.7826516518845387`*^9}, 3.782655395134509*^9, 3.782656929821319*^9, 
   3.782659272522105*^9, 3.7826605316796675`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw9ywkwnAcYxvEdVAitK5EW3YgjZaWurGNFedzHWrt2sa44l1iJq6hRR5dm
glQc08aknUQMpZJUmtFIiGCLihzV6qg2NJ0mYiNCiqqINnqMV7+Zb775ff/3
2ZOYKUxWYjAYkn/f/76bz6I7zyXZUTlP0U8/wKtQbbAYnSOrYcaHfSv6s6dk
bWj2neZdf7xI3oGm6Z3FmfrL5Fdx3MTVdN+3WzYCOy3mE9Gu38nGaCxdu3RD
dcsm0M96fLL7/3szSMqtvsj5ast7we1Ilxf6bN1bIM7im/vxP6yQWcgrHcvT
mHtG3gfruN3qtbN/ka1R8XXnKQd1JfmmbeHZlzOi2a9KtkNnfXfPUJUm2R7O
uz6NV2nXIe/H+kLOzHTZTjIbZW1dapZXXiM7YKlH0TrvwCQ7QjhodGawYA/Z
Ccv5KcPHl0zJzvi50KDwWvFeMgf+ceuSdQNLsgtSBrf9vTJsRT6ADHuWj7HM
muwKk/he5nCTLfktOMZXvIjRsCe74fRkeEtvwX6yOz5em1NfWGCTAfNqte3K
qY6blgFWhe/fMZ11ou4B++k0lcIMDnUP9EsXzzr/6ULdE4LZcVl1tSt1T3xw
tnLlooUbdS+YBeh33r7pTt0LG+WuLdu7Qd0bDw2axfdqPah7o1JvoC73iCd1
HzSzk7QUXC/qPng6lnvB18abui+SEl9Iz+v7UPcFk69xzEzJl7ofkDNRemOJ
LPPDatuUU8uMH3V/BJwxmR+950/dH5dZbxwMmwygHoD6Qt1x/6lA6gE4KtNj
d//KpR4Iraw+tStzQdQDYe93+MPg5zzqXCQ8O/ljnSafOhepv5iJ/HQF1IOg
fUo4fq6RLAtCZvbg5Xy7EOo81LdwbLqGyDIePsp+kP92lJB6MMwLDOXty2RZ
MI5FLnCyT4io81Fy09NwiBVKnQ8uc7qx/RaZIcB3ZY46Dulhm4YA9q13+xJ0
w+legBpTVY0D18hyAVKk44dGJGLah6A2NzpKRzeC9iHQCugoen2ALAuBXcfE
eyu5kbQPAbO46M0GVhTthajXHpGaTJMhROrGKruyIZr2QtydW/t8MiaG9kJY
Lqy/spt5kPYiqEc+6op9QIYIzV9OsZrOxdJehPz0erXlnDjaixDyJOPEBeN4
2ocifyzLYqGCjFD0GtyJH1gmy0KxLa1qwiY2gfahWH343M3lNpkRBv5V72QF
J5H2YWC+a2vFOU+WhWH2UX+lk1ES7cPwPe7XKWrIjHCY9ximc1+S0D4cU2K3
2MNFZFk4OtK1B7h/kOXhMOKoaC9nJtNejLbrTyaT5skQQ8C5NNaalkJ7MaqO
asrlc2S5GD+VBNZcPXKI9hHImFf2q1skIwKjvyleDn0nlfYRkEpKWKobZHkE
+OIN5YvlUtpHInVyh6lQL03+DxNB6J8=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, -208.60377649376755`},
  Method->{},
  PlotRange->{{0, 100.}, {-208.60377649376755`, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{2., 2.}, {4.172075529875351, 
   4.172075529875351}}]], "Output",
 CellChangeTimes->{
  3.46381262521875*^9, 3.463812729484375*^9, 3.46382748978125*^9, 
   3.46650294546875*^9, 3.466654350125*^9, 3.7825908358414583`*^9, 
   3.782590886407711*^9, {3.782590922072133*^9, 3.7825909656863093`*^9}, {
   3.7825932676582994`*^9, 3.7825933929409246`*^9}, {3.7825934703271093`*^9, 
   3.7825935205696135`*^9}, 3.782650502466862*^9, {3.782651647265892*^9, 
   3.7826516518845387`*^9}, 3.782655395134509*^9, 3.782656929821319*^9, 
   3.782659272522105*^9, 3.7826605316816616`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw1lAlMU3ccx0vl6ACh3OhAK0NukKuDgsB3BQqUq0Av4pwO5pTJRpmIZodU
RWEoSBwoGYww0S1MAlVhi+CgmI450iwciTNEjDAiCGEUIofM4Vj4vZc0L59+
3uf/jv5ed+UUZB5is1isDzY+/+83N0MMx7gntyd3K+gLdMS7zJx24xJzMKUb
GB6psiHmYtSKr9k3b0tsD1e7dne9wJ7YGad790j/OOhA7IJB/2slYVJHYh66
8mwSDUZOxG442VdrPKBg2B264YSyJBHDHvjQIFGa6ZjeC5Y62+sPBpn1ffDT
980mfieY8/tBZR1pZaxnri8AKh9lt3iWuZ9A6NuCmnynmPsNwsX6rkL2FnPi
YDy4Zb70g9KUOAT6YOu8J5wtxKEozQ0W/ezBIuZD1aY7Unbsn5hNfhvlTl/P
C86sEIfBefzYt/fyXxCHQ21RYRbIWyQW4OnY4OWgMgNxBKrZqo5853niSHBv
LM2P8/8m3gtJz5M/bYUMR4F3OP1KvwtzfDQkHj5eO2XMejEYrPzUtThvgRgw
3LY8eraPzq8GNM9uxnFkzPW9A0nUj5pA12XyG3xpkr3ffpW8ENXZ/55Y4K+R
F4I3USz2O/WKfCxYIqM1o5l18rGo9mbVlXQzzysO06Knv121YW+yOg5Nrc0H
SouZ5xsPTvuSuvW5Mfl4qKedjjR8xPweIiDVr/j1qhl5EQbZwtj6mjfIJ0Dd
K6tIjrIgnwCDzvv39UVL8olomiwoutNpRT4RhtndI11CZj6SEF7yvC4giOZd
nQRtGstE5MHMkxjuEWPFjm525MWY7qvwuOvOzF8y3Gvt2sUBNJ/qZGijO1pn
opn5TYFXSeXRbjnNtzoF+otu18ePO5NPBZIPx5Y2bCOfCu2Fc3v1A9vJp4H7
zVDO5MZ7tenTwLFuEb+MdiWfjoZf/QMF53aQT0cc99XEyMhO8hJ4ybj7vqzl
bTIkODn1SKCK30XHS2AVq2t5/JJYK8Flofyzsdtu1GdAc/CCX5XqLeozoB/q
WTAPcac+A/kOx2+q1oi1GWganZ993L+b+kys5hetfFznQX0myquC+oUFntRn
ovVeh+nnyV7UZ0J9apwX5u9NfRZSrhwQ1Nn7UJ8F3sNivtbIl/osWC5Leode
EGuzoPGvFxvm/KiX4tH5M9sw50+9FE0TpsJniwHUS9Fa890dzus91EuhaWjc
MVUeSL0M65d6ktodgqiXIbS+xXfhBrFahtGVwqo+QTD1Mgybv3uXP0TMkmOg
sLEoNz+EejlqapO2vm8RSr0c0nRFdnwbsVaOa/K/uj1lfOoVqFZUevM2/mc2
ewUab5n4J7QTqxVwMemf7cwJo16B+yPLPue3h1OvhFf9WenwQ2IoIZx774vO
qwLqlXD0XT2UvD+CeiU+aZ78SuMZSX027i//8iZ7JRL/AdiRo+c=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 100.}, {0, 27.96487592113295}},
  PlotRangeClipping->True,
  PlotRangePadding->{{2., 2.}, {0.5592975184226591, 
   0.5592975184226591}}]], "Output",
 CellChangeTimes->{
  3.46381262521875*^9, 3.463812729484375*^9, 3.46382748978125*^9, 
   3.46650294546875*^9, 3.466654350125*^9, 3.7825908358414583`*^9, 
   3.782590886407711*^9, {3.782590922072133*^9, 3.7825909656863093`*^9}, {
   3.7825932676582994`*^9, 3.7825933929409246`*^9}, {3.7825934703271093`*^9, 
   3.7825935205696135`*^9}, 3.782650502466862*^9, {3.782651647265892*^9, 
   3.7826516518845387`*^9}, 3.782655395134509*^9, 3.782656929821319*^9, 
   3.782659272522105*^9, 3.7826605316886435`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.46381301646875*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{"EXT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "*", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "2.1", "]"}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.05"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.04"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"Re", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[ImaginaryI]", "^", "i"}], "\[Times]", 
              RowBox[{"AN", "[", 
               RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                "\[Pi]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "]"}]}], "/.", 
         "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nfreq"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"SCA", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lambda", "=", 
        RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{
         RowBox[{"nr", "[", "j", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "*", 
          RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n3", "=", 
        RowBox[{"Sqrt", "[", "2.1", "]"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"opt", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]", "\[Rule]", 
           RowBox[{"2", 
            RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
          RowBox[{"r2", "\[Rule]", " ", "0.05"}], ",", " ", 
          RowBox[{"r3", "\[Rule]", " ", "0.04"}], ",", 
          RowBox[{"\[Epsilon]1", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
          RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
          RowBox[{"\[Epsilon]2", "\[Rule]", 
           RowBox[{"n2", "^", "2"}]}], ",", " ", 
          RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
          RowBox[{"\[Epsilon]3", "\[Rule]", 
           RowBox[{"n3", "^", "2"}]}], ",", " ", 
          RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NBG", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
           "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"T1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"-", "2"}], 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
             "  "}]], 
           RowBox[{"Re", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[ImaginaryI]", "^", "i"}], "\[Times]", 
               RowBox[{"AN", "[", 
                RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                 "\[Pi]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "]"}]}], "/.",
           "opt"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "nfreq"}], "}"}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\EXT.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"EXT", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\SCA.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"SCA", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\ABS.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EXT", "-", "SCA"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<D:\\wave.dat\>\"", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"wave", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}]}], "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.463812630078125*^9, {3.46381307715625*^9, 3.463813093890625*^9}, 
   3.463813454578125*^9, {3.463813574078125*^9, 3.4638135796875*^9}, {
   3.463813737515625*^9, 3.463813788265625*^9}, 3.466654591703125*^9, {
   3.46665475665625*^9, 3.46665476415625*^9}, {3.782591053052603*^9, 
   3.7825911647552204`*^9}, 3.7825911996168284`*^9, {3.782591264772955*^9, 
   3.7825912750603547`*^9}, {3.782650517693141*^9, 3.7826505446520348`*^9}, {
   3.782651151585119*^9, 3.782651161504588*^9}, {3.7826515347006116`*^9, 
   3.7826515447686863`*^9}, {3.78265252052833*^9, 3.782652523159259*^9}, {
   3.782655414038947*^9, 3.782655447933295*^9}, {3.78265623584241*^9, 
   3.7826562453719225`*^9}, {3.7826574613211627`*^9, 
   3.7826574669261894`*^9}, {3.782659946378419*^9, 3.7826599523913383`*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw90Q841Accx3GppWbTPbpWz5Nnz1WSJ6Q0c4fcp4STi/uDu7M986wYj414
bkwUJ+vfVJMdh86tqCvMqmki/w7n8dB5zCi2uSFqkkKppuTZ9vjefs/ze37P
696/z3PP7/dbt++AKNLczMws4t/zv+vCMcW1LKqRWYe84NIP0H+8JPZR8gx5
GZYmjp8dfviUzMALLS86/co0mYlM6xy5RcUUeQ0yOvvWVndNkm2QbRnknpP1
hMwCc3z731uiH5PXw06Z9U6y7wTZFp0H+3+rZTwi28HI2yDfUveQbA9ltn71
I94YeTP6b25o+bbxAdkRuY+f1Ts43CdvQWdx1fiJ7BHyVty4X5/ZMzFM3oZe
5uKNpXuHyC4YelrVkfWXkbwdm/KPRVRqBsgfYEo3xk3+v7tiU8W+TxMbTfsP
0d5RLHNqN9kNlk/ZDhE80/+zkRLmqWYkmJ6Xg6Tm7NnXLrNkdyjrPjtv3bsM
C/aAJl41YDXOJHsi0pha/0nNSvIOpB1jy05HLyd7wUauH82zMyNzMftaL/Ww
NX1fgFE7Jav0pe+lAAKsFKfueJje704khquq2dJR6jtx4LT9qhOjpufZBYPg
cMbQNXofil346ND8w9u3+6l746VXb5Go9g51bzSLkhzl3j3Ud2P/mEKd5tlN
fTeuGtgp2e91UfdB/uUjch+OgboP9HfnvhK3tlP3hTSvpmG9to26Lx5Ec8JY
hlbqfnBP/1Uf6KCn7gep45kZ/q1m6jzw7W5OliY0UechfLHmWUyAjro/FGei
TkQdbaDujyw53+Ldy3XU92DQOWKV/fNb1PegzCd/+daYGuoBUH1ux0pdVE09
AF32gxzmzSrqfDhVl98vOP4zdT6OntwWZRt/g/perGOEWW2Lq6S+F8Paxotn
03+iHohk2dWl4cXXqQdi8y8atye916gHIdAn4ou2VWRFEJQtx/13tP1IXYBu
ufTtcykVC4YAltrJSLX3D3S/AC1WyrfiWOUL1gng4HToUuyKMtoLMTrdN7Jh
RSnthUi0ujLr9f4V2gsR2PnK9YzHZdoLkVuiWjsfqaW9CEyOhUWu+hLtRZgP
VfnF/3mR9iJ8N19X0LSZrBNBeMprxqAoob0Yx82XqB8MFtNejPaBmC8T/MgK
Mb6eU2caqy7QXoyNhqYSrRPZLBhxnLkwcfl52gejYfXKO3JnsiIYGcb2mZ3y
72kfjNtv7uJljob2IRC5sS9I6otoH4JCboePblpN+xBU/t4jKnQm60LASrh3
V5Z0jvahSMxL++NQayHtQ9H9pvj0NzZkRSh4rr6p1qkFtA+FpFkzUj6UT3sJ
ytjMNc/5ZEhgTGdM5DSqaC9BCc/GZSubrJMgzfze7sNVebSXoiFroNDZnQwp
+oTn9i9qyaW9FEdkl5yuC8g6KdbFspSLRpS0l2H81cFn1QeV3H8ADDfcCA==

     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  ImageSize->{Automatic, 178.80893625679767`},
  Method->{},
  PlotRange->{{0, 100.}, {0, 2.1642191565105824`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{2., 2.}, {0.04328438313021165, 
   0.04328438313021165}}]], "Output",
 CellChangeTimes->{3.78259108311043*^9, 3.782591114092739*^9, 
  3.78259117023218*^9, 3.7825912415908985`*^9, 3.7825912750055003`*^9, 
  3.7825935681042566`*^9, 3.7826505688183985`*^9, 3.782651218612849*^9, 
  3.782651452251129*^9, 3.7826516081890745`*^9, 3.7826517193530912`*^9, 
  3.7826554679537835`*^9, 3.7826563044299693`*^9, 3.7826564675885897`*^9, 
  3.7826565763536916`*^9, 3.782656995604377*^9, 3.782657341399389*^9, 
  3.7826574874283295`*^9, 3.7826592771327724`*^9, 3.7826599550402513`*^9, 
  3.78266053870591*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw90Q841Accx3GppWbTPbpWz5Nnz1WSJ6Q0c4fcp4STi/uDu7M986wYj414
bkwUJ+vfVJMdh86tqCvMqmki/w7n8dB5zCi2uSFqkkKppuTZ9vjefs/ze37P
696/z3PP7/dbt++AKNLczMws4t/zv+vCMcW1LKqRWYe84NIP0H+8JPZR8gx5
GZYmjp8dfviUzMALLS86/co0mYlM6xy5RcUUeQ0yOvvWVndNkm2QbRnknpP1
hMwCc3z731uiH5PXw06Z9U6y7wTZFp0H+3+rZTwi28HI2yDfUveQbA9ltn71
I94YeTP6b25o+bbxAdkRuY+f1Ts43CdvQWdx1fiJ7BHyVty4X5/ZMzFM3oZe
5uKNpXuHyC4YelrVkfWXkbwdm/KPRVRqBsgfYEo3xk3+v7tiU8W+TxMbTfsP
0d5RLHNqN9kNlk/ZDhE80/+zkRLmqWYkmJ6Xg6Tm7NnXLrNkdyjrPjtv3bsM
C/aAJl41YDXOJHsi0pha/0nNSvIOpB1jy05HLyd7wUauH82zMyNzMftaL/Ww
NX1fgFE7Jav0pe+lAAKsFKfueJje704khquq2dJR6jtx4LT9qhOjpufZBYPg
cMbQNXofil346ND8w9u3+6l746VXb5Go9g51bzSLkhzl3j3Ud2P/mEKd5tlN
fTeuGtgp2e91UfdB/uUjch+OgboP9HfnvhK3tlP3hTSvpmG9to26Lx5Ec8JY
hlbqfnBP/1Uf6KCn7gep45kZ/q1m6jzw7W5OliY0UechfLHmWUyAjro/FGei
TkQdbaDujyw53+Ldy3XU92DQOWKV/fNb1PegzCd/+daYGuoBUH1ux0pdVE09
AF32gxzmzSrqfDhVl98vOP4zdT6OntwWZRt/g/perGOEWW2Lq6S+F8Paxotn
03+iHohk2dWl4cXXqQdi8y8atye916gHIdAn4ou2VWRFEJQtx/13tP1IXYBu
ufTtcykVC4YAltrJSLX3D3S/AC1WyrfiWOUL1gng4HToUuyKMtoLMTrdN7Jh
RSnthUi0ujLr9f4V2gsR2PnK9YzHZdoLkVuiWjsfqaW9CEyOhUWu+hLtRZgP
VfnF/3mR9iJ8N19X0LSZrBNBeMprxqAoob0Yx82XqB8MFtNejPaBmC8T/MgK
Mb6eU2caqy7QXoyNhqYSrRPZLBhxnLkwcfl52gejYfXKO3JnsiIYGcb2mZ3y
72kfjNtv7uJljob2IRC5sS9I6otoH4JCboePblpN+xBU/t4jKnQm60LASrh3
V5Z0jvahSMxL++NQayHtQ9H9pvj0NzZkRSh4rr6p1qkFtA+FpFkzUj6UT3sJ
ytjMNc/5ZEhgTGdM5DSqaC9BCc/GZSubrJMgzfze7sNVebSXoiFroNDZnQwp
+oTn9i9qyaW9FEdkl5yuC8g6KdbFspSLRpS0l2H81cFn1QeV3H8ADDfcCA==

     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  ImageSize->{Automatic, 178.80893625679767`},
  Method->{},
  PlotRange->{{0, 100.}, {0, 2.1642191565105824`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{2., 2.}, {0.04328438313021165, 
   0.04328438313021165}}]], "Output",
 CellChangeTimes->{3.78259108311043*^9, 3.782591114092739*^9, 
  3.78259117023218*^9, 3.7825912415908985`*^9, 3.7825912750055003`*^9, 
  3.7825935681042566`*^9, 3.7826505688183985`*^9, 3.782651218612849*^9, 
  3.782651452251129*^9, 3.7826516081890745`*^9, 3.7826517193530912`*^9, 
  3.7826554679537835`*^9, 3.7826563044299693`*^9, 3.7826564675885897`*^9, 
  3.7826565763536916`*^9, 3.782656995604377*^9, 3.782657341399389*^9, 
  3.7826574874283295`*^9, 3.7826592771327724`*^9, 3.7826599550402513`*^9, 
  3.782660541886388*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{"2.99792458", "*", 
     RowBox[{"10", "^", "8"}]}]}], ";"}], 
  RowBox[{"(*", "\:5149\:901f", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wmax", "=", 
    RowBox[{"2", "*", "3.14159", "*", 
     RowBox[{"c", "/", 
      RowBox[{"(", 
       RowBox[{"300", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ")"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"300", "nm"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"wmin", "=", 
    RowBox[{"2", "*", "3.14159", "*", 
     RowBox[{"c", "/", 
      RowBox[{"(", 
       RowBox[{"1000", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ")"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"1000", "nm"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nfreq", "=", "150"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"wave", "[", "i", "]"}], "=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"300", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "-", "1"}], ")"}], "*", "700", "*", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"-", "9"}]}], "/", 
         RowBox[{"(", 
          RowBox[{"nfreq", "-", "1"}], ")"}]}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"w", "[", "i", "]"}], "=", 
     RowBox[{"2", "*", "3.14159", "*", 
      RowBox[{"c", "/", 
       RowBox[{"wave", "[", "i", "]"}]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wp", "=", 
   RowBox[{"1.5779137936666154", "*", 
    RowBox[{"10", "^", "16"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"epsr", "=", "9.04603"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rd", "=", 
   RowBox[{"5", "*", 
    RowBox[{"10", "^", "13"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"epsilon", "[", "i", "]"}], "=", 
      RowBox[{"epsr", "-", 
       FractionBox[
        RowBox[{"wp", "\[Times]", "wp"}], 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", "i", "]"}], "\[Times]", 
          RowBox[{"w", "[", "i", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", "\[Times]", "rd", "*", 
          RowBox[{"w", "[", "i", "]"}]}]}]]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"nr", "[", "i", "]"}], "=", 
    RowBox[{"Re", "[", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"epsilon", "[", "i", "]"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ni", "[", "i", "]"}], "=", 
     RowBox[{"Im", "[", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"epsilon", "[", "i", "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"EXT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{
        RowBox[{"wave", "[", "j", "]"}], "*", 
        RowBox[{"10", "^", "6"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.05"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.0001"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"Re", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[ImaginaryI]", "^", "i"}], "\[Times]", 
              RowBox[{"AN", "[", 
               RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                "\[Pi]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "]"}]}], "/.", 
         "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "150"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\EXT21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"EXT", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"SCA", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"lambda", "=", 
        RowBox[{
         RowBox[{"wave", "[", "j", "]"}], "*", 
         RowBox[{"10", "^", "6"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n1", "=", "1.1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{
         RowBox[{"nr", "[", "j", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n3", "=", 
        RowBox[{
         RowBox[{"nr", "[", "j", "]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"opt", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Omega]", "\[Rule]", 
           RowBox[{"2", 
            RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
          RowBox[{"r2", "\[Rule]", " ", "0.05"}], ",", " ", 
          RowBox[{"r3", "\[Rule]", " ", "0.0001"}], ",", 
          RowBox[{"\[Epsilon]1", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
          RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
          RowBox[{"\[Epsilon]2", "\[Rule]", 
           RowBox[{"n2", "^", "2"}]}], ",", " ", 
          RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
          RowBox[{"\[Epsilon]3", "\[Rule]", 
           RowBox[{"n3", "^", "2"}]}], ",", " ", 
          RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NBG", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
           "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"T1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"-", "2"}], 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
             "  "}]], 
           RowBox[{"Re", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[ImaginaryI]", "^", "i"}], "\[Times]", 
               RowBox[{"AN", "[", 
                RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                 "\[Pi]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "]"}]}], "/.",
           "opt"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "nfreq"}], "}"}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\SCA21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"SCA", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\ABS21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EXT", "-", "SCA"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<D:\\wave.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"wave", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.475235286640625*^9, 3.475235294171875*^9}, {
   3.475235368921875*^9, 3.475235406484375*^9}, {3.475235572390625*^9, 
   3.47523559559375*^9}, {3.475235655*^9, 3.47523571553125*^9}, {
   3.47523577871875*^9, 3.475235779953125*^9}, {3.47523582225*^9, 
   3.475235830390625*^9}, {3.4752358768125*^9, 3.4752359104375*^9}, 
   3.475236153921875*^9, {3.475238049515625*^9, 3.475238073546875*^9}, {
   3.47523859490625*^9, 3.47523864125*^9}, 3.47523873940625*^9, {
   3.47523877734375*^9, 3.475238812453125*^9}, {3.475238887640625*^9, 
   3.475238891171875*^9}, {3.475239948015625*^9, 3.475239958171875*^9}, {
   3.475240006171875*^9, 3.475240035765625*^9}, {3.475240132125*^9, 
   3.475240145796875*^9}, {3.4752401779375*^9, 3.475240179125*^9}, {
   3.47524150896875*^9, 3.475241512078125*^9}, {3.475242731828125*^9, 
   3.475242732578125*^9}, {3.475244384921875*^9, 3.475244399296875*^9}, {
   3.7825849790534096`*^9, 3.7825849920099773`*^9}, {3.7825850224994855`*^9, 
   3.7825850251829476`*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.6526187632566456`", ",", "1.59118414692661`", ",", "1.5262695355172684`",
    ",", "1.457411101253849`", ",", "1.3840220276873203`", ",", 
   "1.3053411227656986`", ",", "1.2203499796283153`", ",", 
   "1.1276314195464459`", ",", "1.0251087941627453`", ",", 
   "0.9095154423947555`", ",", "0.775152342053472`", ",", 
   "0.610295902827184`", ",", "0.3831162963505878`", ",", 
   "0.12757554813631292`", ",", "0.07732290327153672`", ",", 
   "0.06175684310036983`", ",", "0.05388786497249264`", ",", 
   "0.04909334777123888`", ",", "0.045876880635194295`", ",", 
   "0.04359297999041349`", ",", "0.041912800444345547`", ",", 
   "0.0406493674116777`", ",", "0.03968771554343267`", ",", 
   "0.03895287616052972`", ",", "0.038393669289782`", ",", 
   "0.03797384600467289`", ",", "0.03766694554951935`", ",", 
   "0.037453158579381904`", ",", "0.037317334132831344`", ",", 
   "0.03724766883751188`", ",", "0.03723481896620945`", ",", 
   "0.03727128334982378`", ",", "0.037350964821711796`", ",", 
   "0.03746885232797235`", ",", "0.03762078642356234`", ",", 
   "0.03780328354267256`", ",", "0.03801340243716537`", ",", 
   "0.03824864135667327`", ",", "0.038506857967644956`", ",", 
   "0.038786206315629214`", ",", "0.039085086717128244`", ",", 
   "0.039402105569767115`", ",", "0.03973604284909593`", ",", 
   "0.04008582561912242`", ",", "0.040450506289232704`", ",", 
   "0.040829244647944046`", ",", "0.041221292924946806`", ",", 
   "0.04162598329858615`", ",", "0.04204271739131771`", ",", 
   "0.04247095739139237`", ",", "0.04291021851270183`", ",", 
   "0.04336006256186836`", ",", "0.04382009242631782`", ",", 
   "0.04428994733220918`", ",", "0.04476929874891609`", ",", 
   "0.04525784683892382`", ",", "0.04575531736977196`", ",", 
   "0.04626145901899141`", ",", "0.0467760410145829`", ",", 
   "0.04729885106303024`", ",", "0.047829693524567486`", ",", 
   "0.04836838780176988`", ",", "0.04891476691278033`", ",", 
   "0.04946867622482742`", ",", "0.050029972327307846`", ",", 
   "0.050598522026725115`", ",", "0.051174201448310336`", ",", 
   "0.051756895231280346`", ",", "0.052346495806488334`", ",", 
   "0.052942902746744576`", ",", "0.053546022181380784`", ",", 
   "0.054155766267732774`", ",", "0.054772052713160775`", ",", 
   "0.05539480434203298`", ",", "0.05602394870279353`", ",", 
   "0.05665941771083317`", ",", "0.057301147323398575`", ",", 
   "0.05794907724322261`", ",", "0.058603150647946564`", ",", 
   "0.05926331394274346`", ",", "0.05992951653384497`", ",", 
   "0.060601710620932156`", ",", "0.06127985100657581`", ",", 
   "0.06196389492110868`", ",", "0.0626538018614863`", ",", 
   "0.06334953344284522`", ",", "0.06405105326160312`", ",", 
   "0.06475832676906318`", ",", "0.065471321154592`", ",", 
   "0.06619000523753248`", ",", "0.06691434936709703`", ",", 
   "0.0676443253295603`", ",", "0.06837990626213544`", ",", 
   "0.06912106657297847`", ",", "0.06986778186681557`", ",", 
   "0.0706200288757374`", ",", "0.07137778539474432`", ",", 
   "0.07214103022166657`", ",", "0.07290974310111478`", ",", 
   "0.07368390467214897`", ",", "0.0744634964193809`", ",", 
   "0.07524850062724814`", ",", "0.07603890033722355`", ",", 
   "0.07683467930774068`", ",", "0.07763582197663683`", ",", 
   "0.07844231342593`", ",", "0.07925413934876267`", ",", 
   "0.08007128601835792`", ",", "0.08089374025884592`", ",", 
   "0.08172148941783085`", ",", "0.08255452134057807`", ",", 
   "0.08339282434571042`", ",", "0.08423638720231252`", ",", 
   "0.0850851991083475`", ",", "0.08593924967030006`", ",", 
   "0.0867985288839648`", ",", "0.08766302711630573`", ",", 
   "0.08853273508831698`", ",", "0.08940764385882191`", ",", 
   "0.09028774480915028`", ",", "0.09117302962863909`", ",", 
   "0.09206349030090517`", ",", "0.0929591190908427`", ",", 
   "0.09385990853230083`", ",", "0.09476585141640091`", ",", 
   "0.0956769407804537`", ",", "0.09659316989744264`", ",", 
   "0.097514532266038`", ",", "0.09844102160111232`", ",", 
   "0.09937263182472703`", ",", "0.10030935705756377`", ",", 
   "0.10125119161077467`", ",", "0.10219812997822812`", ",", 
   "0.103150166829128`", ",", "0.10410729700098487`", ",", 
   "0.10506951549292048`", ",", "0.10603681745928699`", ",", 
   "0.10700919820358366`", ",", "0.10798665317265528`", ",", 
   "0.10896917795115676`", ",", "0.10995676825627071`", ",", 
   "0.11094941993266332`", ",", "0.11194712894766712`", ",", 
   "0.11294989138667869`", ",", "0.1139577034487595`", ",", 
   "0.11497056144243047`", ",", "0.1159884617816501`", ",", 
   "0.11701140098196615`", ",", "0.11803937565683345`", ",", 
   "0.11907238251408853`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.463812985015625*^9, 3.463813188078125*^9, 3.4638135500625*^9, 
   3.463813674046875*^9, 3.46650304309375*^9, 3.4666546963125*^9, 
   3.4666548705*^9, 3.475235299234375*^9, 3.475235394265625*^9, 
   3.4752354424375*^9, 3.475235530015625*^9, {3.4752355741875*^9, 
   3.47523560978125*^9}, 3.475235657890625*^9, {3.475235690828125*^9, 
   3.4752357046875*^9}, 3.475235741890625*^9, 3.4752357805*^9, 
   3.475235830890625*^9, {3.475235879203125*^9, 3.4752359118125*^9}, 
   3.475236156875*^9, 3.475238616703125*^9, {3.475238652328125*^9, 
   3.475238671515625*^9}, 3.475238706390625*^9, 3.475238741296875*^9, {
   3.475238784078125*^9, 3.475238812765625*^9}, 3.47523889315625*^9, 
   3.475239960390625*^9, 3.475240030953125*^9, 3.475240061859375*^9, 
   3.475240146203125*^9, 3.475241512921875*^9, 3.475242759046875*^9, 
   3.4752443879375*^9, 3.782584956819168*^9, 3.7825849927115755`*^9, 
   3.7825850288248568`*^9, 3.782586169536317*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw11gtUjHkYBvCv1l2nLRM7id0pmiPaklTUmp5RSMnMdJmmmmpmVogO0m6t
bOtDiYoklzhJF+tW2Jy2Ldn6uihMF5RmaZdQWLElQoTdPb3NOXPm/OaZ57xn
vpn5v2OuWe8Trs8wzMH/7v8/Dt16Xa2bI3Mv7vrLlZ7AnX3norcqdOQxEL/5
5Ub1/JtkI3w5L43f0aMlmyBsYNV2ZqCWzIdxdG7nfVEleQo8Dvfvn7WulCxA
gp25Wa62hGyBKzu9NrdvukSejtVtNeyFkDqyEK/bKibcNG4hz0D5naDbJbYd
5JnQTutWzd36lGyN3tbYQ5OLXpFt8OSl0Nwm/SN5NnyclLLn9iMxZDsk8r+S
8dLGk+fg5KczwtU8Y7I9rn5dnTCpdyJ5LiaVdIhknBnZAZNFJ315/73vITui
NctUeXcqj+yEy8vNimx/NSLPw6FThZ5xrobk+fiBWxH3unJ4vjMmJRbw3fPH
kl2gDFUm8ZpGk79B3KJbVvZzRpEXwNnQuYtfN4Iswkj++sI12z4ju0I8uC9v
llqfDPRdfCj/NkRvyCxwsGhA0L2RoVyMew9CTDK++TR0vVgxwgv2Z1mVfaDr
txBGJ4KPFMsHKV8IvvII38T4PeVuiPdqWantHKDcDcXbYkd0Nb2l3B17p3nu
bm94Q7k7zqb1NO748zXli5CUUu9mMNhP+SI4dn9addOKzCwGT9iCmBX0+bKL
4S1u0lafeUn5EgRYKZ6cft9H+RIIKo/HieRkxgMtjNnu82UvKPfAGEmU2N2S
zCzFEZemtYrMXsqXInziT2WBE8iMJzxELgeSLXso98SYjAR/rzn/UO6Fc7L6
2Raezyn3gve+dDNp5DPKl8FFt1RvRmY35csQI9U7ZtA4/P31xkrHBQXrxpFZ
b5hU5oq0kr8pX47LhzZHn8l6QvlyBGy+ZZ/d+5hyCZBqZSv2IrMSuPzW8cKh
8BHlUsQVVZkKeWRIMb3WMb9qSxe9XgpD/36vihedQ+ak2GMxeYxuNZmR4fxO
UZK28yH1ZXB4EFEfFk5mZQBrXBz89AH1ZRi3Nqs5OZrM+OBTIP9ROUOGDwau
D9Zz6fep74N5KXoG64Rkzgd1O211RyqGf+++2DIt6owgiAxfzK4bjCh5cY/6
vrj3zlYudSBzvjATzRI3/XSX+n44H/VbY18jnXfww7UPxe3bLcisH+bX7pB4
/vgn9f3wNl9x17i9nfr++JBcdfeUiAx/KGZIp3acuEN9f0xcm12czCNz/tBE
ZDyJT7hNfTk2uiWOSB/4g/pyuCzvdzm6kczKER5zand8D52/nBxJWzpPGW4Y
Po8DYFiQ02rzqo36ATjNxv/x+2YyGwD5WOXjrFFkLgBRug0p5/bfor4Cds0X
MtosyVAgQbtT/11ZK/UVmGGc9eGjlMwpINIrrWh4Onz+BuLqxdxEryQyAlEu
b01eISSzgSi0N3qpd4X2BReIkpCzNYaRw/sjCMdS83QxE8gIQlKc/S1h+Q3q
ByHyR+fpBivJXBBMJfpdJjwyE4zSdz8/tq2+Tv1gCHc8z18WTWaD0fgm2y5Y
SOaCYZ8Xuy2zpJn6SmiPL5lpMZ0MJSoarF87HmiivhK1Nqap5WPJnBLPW7V7
D2xtpH4I/JouZxUMNlA/BBf6rtt1xZHZEExe9XnRzEHaj1wIDDNTZOHs8L4M
ResbfLFlNBmhqA44eE2Tfo36oZA6ufW+n0rmQiHWHa5yPHuV+mGI9ZxtybiS
EQaJ5cOTi1quUD8MD2usY/ojyFwYHGIb/D/qkxkVuh3Kjkmy64csUEFdEux8
24UMFfpMDfantNP+ValQmNZ8NCCezKpwcbdPnY05OUeF7Jgp/fr1l2meCnnn
BxLr1pE7VOCUh90j+WRGjbnmytWPa+j/gkCNUWtke2dFkaGG7h9VpbWArFJD
zylbce96Dc1XI9Wo1mzednKOGvdHtplbO5E5NTLedd3+5Vk1zVdDazc48lI+
mdEgwlRQ6qYkCzRY681KRJPI0CAnsPT7vBtVNF+Dm7o5U1btIbMaKDJPbNq+
jJyjQefBs6N7xpM5DXalfsfmNnCu/wLLcc+D
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  ImageSize->{394., Automatic},
  Method->{},
  PlotRange->{{0, 150.}, {0, 3.304236259611703}},
  PlotRangeClipping->True,
  PlotRangePadding->{{3., 3.}, {0.06608472519223406, 
   0.06608472519223406}}]], "Output",
 CellChangeTimes->{
  3.463812985015625*^9, 3.463813188078125*^9, 3.4638135500625*^9, 
   3.463813674046875*^9, 3.46650304309375*^9, 3.4666546963125*^9, 
   3.4666548705*^9, 3.475235299234375*^9, 3.475235394265625*^9, 
   3.4752354424375*^9, 3.475235530015625*^9, {3.4752355741875*^9, 
   3.47523560978125*^9}, 3.475235657890625*^9, {3.475235690828125*^9, 
   3.4752357046875*^9}, 3.475235741890625*^9, 3.4752357805*^9, 
   3.475235830890625*^9, {3.475235879203125*^9, 3.4752359118125*^9}, 
   3.475236156875*^9, 3.475238616703125*^9, {3.475238652328125*^9, 
   3.475238671515625*^9}, 3.475238706390625*^9, 3.475238741296875*^9, {
   3.475238784078125*^9, 3.475238812765625*^9}, 3.47523889315625*^9, 
   3.475239960390625*^9, 3.475240030953125*^9, 3.475240061859375*^9, 
   3.475240146203125*^9, 3.475241512921875*^9, 3.475242759046875*^9, 
   3.4752443879375*^9, 3.782584956819168*^9, 3.7825849927115755`*^9, 
   3.7825850288248568`*^9, 3.7825861737878675`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw11gtUjHkYBvCv1l2nLRM7id0pmiPaklTUmp5RSMnMdJmmmmpmVogO0m6t
bOtDiYoklzhJF+tW2Jy2Ldn6uihMF5RmaZdQWLElQoTdPb3NOXPm/OaZ57xn
vpn5v2OuWe8Trs8wzMH/7v8/Dt16Xa2bI3Mv7vrLlZ7AnX3norcqdOQxEL/5
5Ub1/JtkI3w5L43f0aMlmyBsYNV2ZqCWzIdxdG7nfVEleQo8Dvfvn7WulCxA
gp25Wa62hGyBKzu9NrdvukSejtVtNeyFkDqyEK/bKibcNG4hz0D5naDbJbYd
5JnQTutWzd36lGyN3tbYQ5OLXpFt8OSl0Nwm/SN5NnyclLLn9iMxZDsk8r+S
8dLGk+fg5KczwtU8Y7I9rn5dnTCpdyJ5LiaVdIhknBnZAZNFJ315/73vITui
NctUeXcqj+yEy8vNimx/NSLPw6FThZ5xrobk+fiBWxH3unJ4vjMmJRbw3fPH
kl2gDFUm8ZpGk79B3KJbVvZzRpEXwNnQuYtfN4Iswkj++sI12z4ju0I8uC9v
llqfDPRdfCj/NkRvyCxwsGhA0L2RoVyMew9CTDK++TR0vVgxwgv2Z1mVfaDr
txBGJ4KPFMsHKV8IvvII38T4PeVuiPdqWantHKDcDcXbYkd0Nb2l3B17p3nu
bm94Q7k7zqb1NO748zXli5CUUu9mMNhP+SI4dn9addOKzCwGT9iCmBX0+bKL
4S1u0lafeUn5EgRYKZ6cft9H+RIIKo/HieRkxgMtjNnu82UvKPfAGEmU2N2S
zCzFEZemtYrMXsqXInziT2WBE8iMJzxELgeSLXso98SYjAR/rzn/UO6Fc7L6
2Raezyn3gve+dDNp5DPKl8FFt1RvRmY35csQI9U7ZtA4/P31xkrHBQXrxpFZ
b5hU5oq0kr8pX47LhzZHn8l6QvlyBGy+ZZ/d+5hyCZBqZSv2IrMSuPzW8cKh
8BHlUsQVVZkKeWRIMb3WMb9qSxe9XgpD/36vihedQ+ak2GMxeYxuNZmR4fxO
UZK28yH1ZXB4EFEfFk5mZQBrXBz89AH1ZRi3Nqs5OZrM+OBTIP9ROUOGDwau
D9Zz6fep74N5KXoG64Rkzgd1O211RyqGf+++2DIt6owgiAxfzK4bjCh5cY/6
vrj3zlYudSBzvjATzRI3/XSX+n44H/VbY18jnXfww7UPxe3bLcisH+bX7pB4
/vgn9f3wNl9x17i9nfr++JBcdfeUiAx/KGZIp3acuEN9f0xcm12czCNz/tBE
ZDyJT7hNfTk2uiWOSB/4g/pyuCzvdzm6kczKER5zand8D52/nBxJWzpPGW4Y
Po8DYFiQ02rzqo36ATjNxv/x+2YyGwD5WOXjrFFkLgBRug0p5/bfor4Cds0X
MtosyVAgQbtT/11ZK/UVmGGc9eGjlMwpINIrrWh4Onz+BuLqxdxEryQyAlEu
b01eISSzgSi0N3qpd4X2BReIkpCzNYaRw/sjCMdS83QxE8gIQlKc/S1h+Q3q
ByHyR+fpBivJXBBMJfpdJjwyE4zSdz8/tq2+Tv1gCHc8z18WTWaD0fgm2y5Y
SOaCYZ8Xuy2zpJn6SmiPL5lpMZ0MJSoarF87HmiivhK1Nqap5WPJnBLPW7V7
D2xtpH4I/JouZxUMNlA/BBf6rtt1xZHZEExe9XnRzEHaj1wIDDNTZOHs8L4M
ResbfLFlNBmhqA44eE2Tfo36oZA6ufW+n0rmQiHWHa5yPHuV+mGI9ZxtybiS
EQaJ5cOTi1quUD8MD2usY/ojyFwYHGIb/D/qkxkVuh3Kjkmy64csUEFdEux8
24UMFfpMDfantNP+ValQmNZ8NCCezKpwcbdPnY05OUeF7Jgp/fr1l2meCnnn
BxLr1pE7VOCUh90j+WRGjbnmytWPa+j/gkCNUWtke2dFkaGG7h9VpbWArFJD
zylbce96Dc1XI9Wo1mzednKOGvdHtplbO5E5NTLedd3+5Vk1zVdDazc48lI+
mdEgwlRQ6qYkCzRY681KRJPI0CAnsPT7vBtVNF+Dm7o5U1btIbMaKDJPbNq+
jJyjQefBs6N7xpM5DXalfsfmNnCu/wLLcc+D
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  ImageSize->{394., Automatic},
  Method->{},
  PlotRange->{{0, 150.}, {0, 3.304236259611703}},
  PlotRangeClipping->True,
  PlotRangePadding->{{3., 3.}, {0.06608472519223406, 
   0.06608472519223406}}]], "Output",
 CellChangeTimes->{
  3.463812985015625*^9, 3.463813188078125*^9, 3.4638135500625*^9, 
   3.463813674046875*^9, 3.46650304309375*^9, 3.4666546963125*^9, 
   3.4666548705*^9, 3.475235299234375*^9, 3.475235394265625*^9, 
   3.4752354424375*^9, 3.475235530015625*^9, {3.4752355741875*^9, 
   3.47523560978125*^9}, 3.475235657890625*^9, {3.475235690828125*^9, 
   3.4752357046875*^9}, 3.475235741890625*^9, 3.4752357805*^9, 
   3.475235830890625*^9, {3.475235879203125*^9, 3.4752359118125*^9}, 
   3.475236156875*^9, 3.475238616703125*^9, {3.475238652328125*^9, 
   3.475238671515625*^9}, 3.475238706390625*^9, 3.475238741296875*^9, {
   3.475238784078125*^9, 3.475238812765625*^9}, 3.47523889315625*^9, 
   3.475239960390625*^9, 3.475240030953125*^9, 3.475240061859375*^9, 
   3.475240146203125*^9, 3.475241512921875*^9, 3.475242759046875*^9, 
   3.4752443879375*^9, 3.782584956819168*^9, 3.7825849927115755`*^9, 
   3.7825850288248568`*^9, 3.7825861784000587`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\wave.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"wave", "[", "i", "]"}], "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"300", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"i", "-", "1"}], ")"}], "*", "700", "*", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"-", "9"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"nfreq", "-", "1"}], ")"}]}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nfreq"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.475240211*^9, 3.47524023296875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{"EXT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.05"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.01"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"Re", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", "\[ImaginaryI]", ")"}], "^", "i"}], "\[Times]", 
              RowBox[{"AN", "[", 
               RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                "\[Pi]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "11"}], ",", "11"}], "}"}]}], "]"}], "]"}]}], "/.",
          "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\EXT21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"EXT", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.46381379646875*^9, 3.46381379671875*^9}, {
   3.46381438078125*^9, 3.463814382640625*^9}, 3.463827497375*^9, {
   3.466503289703125*^9, 3.46650329140625*^9}, {3.466503525890625*^9, 
   3.466503528421875*^9}, {3.46650370228125*^9, 3.46650370390625*^9}, 
   3.46665436328125*^9, {3.47523535015625*^9, 3.475235356*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], PointBox[CompressedData["
1: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
7R7RxA==
    "]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.46381389375*^9, 3.4638144790625*^9, 3.463827594234375*^9,
   3.466503385359375*^9, 3.466503694296875*^9, 3.466503813875*^9, 
  3.46665448346875*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{"SCA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "2.1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.135"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.1125"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["2", 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"AN", "[", 
               RowBox[{"0", ",", "opt"}], "]"}], "]"}], "^", "2"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"AN", "[", 
                  RowBox[{"i", ",", "opt"}], "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}], 
           ")"}]}], "/.", "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"EXT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "2.1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.135"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.1125"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"Re", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", "\[ImaginaryI]", ")"}], "^", "i"}], "\[Times]", 
              RowBox[{"AN", "[", 
               RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                "\[Pi]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], "]"}]}], "/.",
          "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\SCA21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"SCA", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\EXT21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"EXT", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\ABS21.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EXT", "-", "SCA"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"SCA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "3.3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.135"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.1125"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["2", 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"AN", "[", 
               RowBox[{"0", ",", "opt"}], "]"}], "]"}], "^", "2"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"AN", "[", 
                  RowBox[{"i", ",", "opt"}], "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}], 
           ")"}]}], "/.", "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"EXT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "3.3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.135"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.1125"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"Re", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", "\[ImaginaryI]", ")"}], "^", "i"}], "\[Times]", 
              RowBox[{"AN", "[", 
               RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                "\[Pi]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], "]"}]}], "/.",
          "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\SCA33.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"SCA", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\EXT33.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"EXT", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\ABS33.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EXT", "-", "SCA"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"SCA", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "4.1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.135"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.1125"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["2", 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"AN", "[", 
               RowBox[{"0", ",", "opt"}], "]"}], "]"}], "^", "2"}], "+", 
            RowBox[{"2", "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"AN", "[", 
                  RowBox[{"i", ",", "opt"}], "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "10"}], "}"}]}], "]"}]}]}], 
           ")"}]}], "/.", "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"EXT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lambda", "=", 
       RowBox[{"wave", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n1", "=", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n2", "=", 
       RowBox[{
        RowBox[{"nr", "[", "j", "]"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"ni", "[", "j", "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
      RowBox[{"n3", "=", 
       RowBox[{"Sqrt", "[", "4.1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"opt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Omega]", "\[Rule]", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "lambda"}]}]}], ",", 
         RowBox[{"r2", "\[Rule]", " ", "0.135"}], ",", " ", 
         RowBox[{"r3", "\[Rule]", " ", "0.1125"}], ",", 
         RowBox[{"\[Epsilon]1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"n1", "^", "2"}], ")"}]}], ",", " ", 
         RowBox[{"\[Mu]1", "\[Rule]", "1."}], ",", 
         RowBox[{"\[Epsilon]2", "\[Rule]", 
          RowBox[{"n2", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]2", "\[Rule]", "1."}], ",", " ", 
         RowBox[{"\[Epsilon]3", "\[Rule]", 
          RowBox[{"n3", "^", "2"}]}], ",", " ", 
         RowBox[{"\[Mu]3", "\[Rule]", "1."}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NBG", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]", " ", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], "r2"}], "+", 
          "10"}], ")"}], "/.", "opt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"-", "2"}], 
           RowBox[{"\[Omega]", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"\[Epsilon]1", " ", "\[Mu]1"}], "]"}], " ", "r2", 
            "  "}]], 
          RowBox[{"Re", "[", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", "\[ImaginaryI]", ")"}], "^", "i"}], "\[Times]", 
              RowBox[{"AN", "[", 
               RowBox[{"i", ",", "opt"}], "]"}], "\[Times]", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "\[Times]", "i", "\[Times]", 
                "\[Pi]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], "]"}]}], "/.",
          "opt"}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\SCA41.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"SCA", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\EXT41.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"EXT", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<C:\\ABS41.dat\>\"", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"EXT", "-", "SCA"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.45814187675*^9, 3.45814195*^9}, {3.458142021453125*^9, 
   3.458142110140625*^9}, {3.4581421586875*^9, 3.458142223703125*^9}, 
   3.458142263328125*^9, {3.458142293515625*^9, 3.45814231559375*^9}, {
   3.458142359328125*^9, 3.4581424315*^9}, 3.45814246925*^9, {
   3.45814250640625*^9, 3.4581425095*^9}, {3.458142544875*^9, 
   3.458142600015625*^9}, {3.458145147875*^9, 3.4581452825625*^9}, {
   3.45814535109375*^9, 3.458145352328125*^9}, 3.458148549828125*^9, {
   3.458148666984375*^9, 3.45814868971875*^9}, {3.458152021703125*^9, 
   3.45815203721875*^9}, {3.458152324328125*^9, 3.458152327328125*^9}, {
   3.45820902859375*^9, 3.458209032609375*^9}, {3.458355411328125*^9, 
   3.45835542378125*^9}, {3.458485593625*^9, 3.45848561378125*^9}, 
   3.458486085890625*^9, {3.4584862699375*^9, 3.458486270359375*^9}, {
   3.458564174609375*^9, 3.45856418478125*^9}, 3.458564274140625*^9, {
   3.458564604859375*^9, 3.458564605109375*^9}, {3.45856662509375*^9, 
   3.458566629765625*^9}, {3.458566793625*^9, 3.4585667973125*^9}, {
   3.458567702984375*^9, 3.458567704875*^9}, {3.458568006359375*^9, 
   3.4585680125625*^9}, {3.458900929703125*^9, 3.45890093325*^9}, {
   3.460874321140625*^9, 3.460874323796875*^9}, {3.46087452321875*^9, 
   3.4608745765625*^9}}]
},
WindowSize->{1520, 727},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->FEPrivate`FrontEndResource[
 "FEExpressions", "CompatibilityToolbar"],
Magnification->1,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 19739, 469, 1243, "Input"],
Cell[20309, 493, 504, 7, 52, "Output"]
}, Open  ]],
Cell[20828, 503, 44, 1, 4, "PageBreak",
 PageBreakBelow->True],
Cell[CellGroupData[{
Cell[20897, 508, 8495, 250, 669, "Input"],
Cell[29395, 760, 558, 9, 48, "Output"],
Cell[29956, 771, 559, 9, 48, "Output"],
Cell[30518, 782, 2389, 44, 239, "Output"],
Cell[32910, 828, 2389, 44, 244, "Output"]
}, Open  ]],
Cell[35314, 875, 67, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[35406, 880, 7538, 190, 484, "Input"],
Cell[42947, 1072, 2470, 46, 194, "Output"],
Cell[45420, 1120, 2471, 46, 226, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47928, 1171, 11304, 312, 720, "Input"],
Cell[59235, 1485, 5647, 92, 212, "Output"],
Cell[64885, 1579, 3536, 63, 264, "Output"],
Cell[68424, 1644, 3536, 63, 264, "Output"]
}, Open  ]],
Cell[71975, 1710, 793, 24, 31, "Input"],
Cell[CellGroupData[{
Cell[72793, 1738, 3453, 87, 198, "Input"],
Cell[76249, 1827, 8397, 142, 240, "Output"]
}, Open  ]],
Cell[84661, 1972, 20029, 517, 1208, "Input"]
}
]
*)

(* End of internal cache information *)
